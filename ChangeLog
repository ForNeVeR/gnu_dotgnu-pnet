
2001-11-09  Rhys Weatherley  <rweather@southern-storm.com.au>

* include/il_values.h, support/test_float.c, support/convert.c,
support/Makefile.am: add "ILNativeFloatIsNaN" and "ILNativeFloatIsFinite".

* codegen/cg_cast.tc: check for overflow during constant casts.

* support/value.c: remove obsolete file.

* configure.in, include/il_config.h.in, include/il_values.h: make native
integers the same size as native pointers, to be consistent with the ECMA
requirements.

* engine/cvm.h, engine/engine.h: pad CVM stack words to a multiple of
the best alignment so that 64-bit platforms always have an aligned stack.

* engine/lib_defs.h, engine/heap.c: change the definition of the object
header so that it is aligned on the machine's best alignment boundary.

* Makefile.am, configure.in, libgc/*: check in the Hans-Boehm garbage
collection library, version 6.0.

* include/il_gc.h, include/Makefile.am, support/hb_gc.c, support/Makefile.am:
implement the garbage collection API in terms of the Hans-Boehm collector.

* include/il_engine.h, engine/engine.h, engine/heap.h, engine/heap.c,
engine/process.c, engine/Makefile.am: modify the engine to use the garbage
collector instead of the dummy heap implementation.

* engine/ilrun.c: add the `-H' (heap size) option to the engine, and
initialize the engine using "ILExecInit".

2001-11-08  Rhys Weatherley  <rweather@southern-storm.com.au>

* csant/Makefile.am, csant/csant_fileset.h, csant/csant_fileset.c,
csant/csant.c, csant/csant_build.c, csant/csant_cscc.c, csant/csant_defs.h,
csant/csant_task.c: implement "<compile>" and related elements.

* csant/csant_build.c: length error in memory allocation.

* csant/csant_fileset.c: introduce some robustness into the fileset API's.

* csant/csant_fileset.c: fix the regular expression handling for filesets.

* csant/csant_cscc.c: return the correct return code when the arguments
have been parsed successfully.

* csant/csant_cscc.c: check the input sources to see if they are newer
than the output before building the output file.

* csant/csant_cscc.c: adjust the output filename with respect to
the base directory.

* include/il_values.h, include/il_types.h, image/types.c, codegen/cg_arith.tc,
codegen/cg_coerce.c, engine/verify_arith.c, cscc/cs_internal.h,
cscc/cs_grammar.y, cscc/cs_scanner.l, cscc/cs_oper.tc, support/Makefile.am:
remove all references to "ILValue" and "ILValueType" from the code, because
they are now obsolete.

* include/il_values.h, image/image.h: move the "IL_WRITE_*" macros from
"image.h" to "il_values.h" so that they can be reused elsewhere in the code.

* include/il_values.h, support/Makefile.am, support/mul_long.c,
support/rem_float.c, codegen/cg_arith.tc, engine/cvm_arith.c: implement
the and use helper functions "ILInt64MulOvf", "ILUInt64MulOvf", and
"ILNativeFloatRem".

* include/il_values.h, support/Makefile.am, support/convert.c,
engine/cvm_conv.c, codegen/cg_cast.tc: implement helper functions
for difficult numeric conversions in "support".

* include/il_align.h, support/mempool.c, support/memstack.c, engine/verify.c:
detect the target platform's alignment better and then use it within various
memory allocators in the code.

2001-11-07  Rhys Weatherley  <rweather@southern-storm.com.au>

* doc/l10n.html: check in a proposal for a new resource system for C#.

2001-11-05  Rhys Weatherley  <rweather@southern-storm.com.au>

* ilasm/ilasm_build.h, ilasm/ilasm_build.c, ilasm/ilasm_grammar.y:
use a different nested class separator than '/' because Mercury wants
to use that within its identifiers.

* csant/Makefile.am, csant/.cvsignore, csant/csant.c, csant/csant_dir.c,
csant/csant_dir.h, csant/csant_cscc.c, csant/csant_defs.h, csant/csant_build.c,
csant/csant_parse.c, csant/csant_prop.c, csant/csant_task.c, configure.in,
Makefile.am: add the "csant" program to the build tree.

2001-11-04  Rhys Weatherley  <rweather@southern-storm.com.au>

* engine/verify_arith.c, engine/verify_const.c, engine/verify_ptr.c,
engine/verify_branch.c, engine/verify_conv.c: make sure that the
"typeInfo" part of a stack item is zeroed after arithmetic instructions.
This is needed to prevent confusion between "I" used as numeric,
pointer, and delegate types.

* engine/verify.c: modify "TypeToEngineType" and "AssignCompatible"
to pass method pointers around the system as type "I".

* include/il_coder.h, engine/ilverify.c, engine/verify_call.c,
engine/cvmc.c, engine/cvmc_call.c: verification for "ldftn" and "ldvirtfn".

* engine/verify.c: modify some comments.  The latest ECMA spec does
allow verifiable method pointers after all.

* engine/cvm.h, engine/cvm_dasm.c, engine/cvm_call.c, engine/cvmc_call.c:
implement the CVM parts of "ldftn", "ldvirtfn", and "ldinterfftn".

* libffi/x86/win32.S: include <ffi_private.h> to define constants such
as "FFI_TYPE_FLOAT", etc.

2001-11-03  Rhys Weatherley  <rweather@southern-storm.com.au>

* ChangeLog, doc/ChangeLog-1: move the contents of "ChangeLog" to
"doc/ChangeLog-1", because it was starting to get too big to manage.
