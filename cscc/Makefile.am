
SUBDIRS = common csharp c vb java bf cpp

noinst_PROGRAMS = cscc-cs cscc-c-s cscc-vb cscc-java cscc csdoc cscc-bf
man_MANS        = cscc.1 csdoc.1
EXTRA_DIST      = $(man_MANS)

cscc_SOURCES = cscc.c
cscc_LDADD   = common/libILCCommon.a ../ilasm/libILAsm.a \
			   ../ilalink/libILLink.a \
			   ../dumpasm/libILDumpAsm.a ../image/libILImage.a \
			   ../support/libILSupport.a

cscc_cs_SOURCES = cs_main.c
cscc_cs_LDADD   = csharp/libILCSharp.a common/libILCCommon.a \
				  ../codegen/libILCodeGen.a ../dumpasm/libILDumpAsm.a \
				  ../image/libILImage.a ../support/libILSupport.a

cscc_c_s_SOURCES = c_main.c
cscc_c_s_LDADD   = c/libILCLang.a common/libILCCommon.a \
				   ../codegen/libILCodeGen.a ../dumpasm/libILDumpAsm.a \
				   ../image/libILImage.a ../support/libILSupport.a

cscc_vb_SOURCES = vb_main.c
cscc_vb_LDADD   = vb/libILVB.a csharp/libILCSharp.a common/libILCCommon.a \
				  ../codegen/libILCodeGen.a ../dumpasm/libILDumpAsm.a \
				  ../image/libILImage.a ../support/libILSupport.a

cscc_java_SOURCES = java_main.c
cscc_java_LDADD   = java/libILJava.a common/libILCCommon.a \
				  ../codegen/libILCodeGen.a ../dumpasm/libILDumpAsm.a \
				  ../image/libILImage.a ../support/libILSupport.a

csdoc_SOURCES = csdoc.c
csdoc_LDADD   = csharp/libILCSharp.a common/libILCCommon.a \
				../codegen/libILCodeGen.a ../dumpasm/libILDumpAsm.a \
				../image/libILImage.a ../support/libILSupport.a

cscc_bf_SOURCES = bf_main.c
cscc_bf_LDADD   = bf/libILBf.a common/libILCCommon.a \
				  ../codegen/libILCodeGen.a ../dumpasm/libILDumpAsm.a \
				  ../image/libILImage.a ../support/libILSupport.a

AM_CFLAGS = -I$(top_srcdir) -I$(top_builddir) -I$(top_srcdir)/include

## The "cscc" compiler is symlinked as "cli-unknown-gcc" to fool
## autoconf-using cross-compiler systems into using "cscc" to compile
## C code into IL.  It isn't a real gcc implementation, of course.

install-exec-local:
	@$(NORMALL_INSTALL)
	$(mkinstalldirs) $(DESTDIR)$(libdir)/cscc/plugins
	$(mkinstalldirs) $(DESTDIR)$(bindir)
	$(INSTALL_PROGRAM) cscc-cs $(DESTDIR)$(libdir)/cscc/plugins/cscc-cs
	$(INSTALL_PROGRAM) cscc-c-s $(DESTDIR)$(libdir)/cscc/plugins/cscc-c-s
	$(INSTALL_PROGRAM) cscc-vb $(DESTDIR)$(libdir)/cscc/plugins/cscc-vb
	$(INSTALL_PROGRAM) cscc-java $(DESTDIR)$(libdir)/cscc/plugins/cscc-java
	$(INSTALL_PROGRAM) cscc-bf $(DESTDIR)$(libdir)/cscc/plugins/cscc-bf
	$(INSTALL_PROGRAM) cscc $(DESTDIR)$(bindir)/cscc
	$(INSTALL_PROGRAM) csdoc $(DESTDIR)$(bindir)/csdoc
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-csharp
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-b
	rm -f $(DESTDIR)$(bindir)/cli-unknown-gcc
	$(LN_S) cscc-cs $(DESTDIR)$(libdir)/cscc/plugins/cscc-csharp
	$(LN_S) cscc-bf $(DESTDIR)$(libdir)/cscc/plugins/cscc-b
	$(LN_S) cscc $(DESTDIR)$(bindir)/cli-unknown-gcc

uninstall-local:
	@$(NORMALL_UNINSTALL)
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-csharp
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-cs
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-c-s
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-vb
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-java
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-bf
	rm -f $(DESTDIR)$(libdir)/cscc/plugins/cscc-b
	rm -f $(DESTDIR)$(bindir)/cscc
	rm -f $(DESTDIR)$(bindir)/csdoc
	rm -f $(DESTDIR)$(bindir)/cli-unknown-gcc
